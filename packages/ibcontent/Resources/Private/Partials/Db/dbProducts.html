{namespace v=FluidTYPO3\Vhs\ViewHelpers}

<f:comment>see MA#2437</f:comment>

<f:comment>products</f:comment>
<f:if condition="{products}">
  <div class="row columns ib-content-module ib-collapsible ib-background-white ib-noTopBottomPadding">
    <div class="row" id="ib-collapsible-{uid}{iterator.cycle}-products">
      <div class="columns small-1 large-1-2col ib-collapsible-icon ib-collapsible-trigger"
        data-ibcollapsibleid="{uid}{iterator.cycle}-products">
        <span class="ib-iconwrapper">
          <i class="ib-icon-arrow-right"></i>
          <span>
      </div>
      <div class="columns small-10 large-6-2col end">
        <div class="ib-collapsible-header ib-collapsible-trigger rs_preserve"
          data-ibcollapsibleid="{uid}{iterator.cycle}-products"
          id="{v:format.eliminate(content:collapsible.ItemWrap.title, whitespace:1)}">
          <f:if condition="{location.Location.related_products_headline} != ''">
            <f:then>
              <h2 class="ib-headline">{location.Location.related_products_headline}</h2>
            </f:then>
            <f:else>
              <h2 class="ib-headline">Weitere Angebote</h2>
            </f:else>
          </f:if>
        </div>
        <div class="row ib-collapsible-content" id="ib-collapsible-content-{uid}{iterator.cycle}-products">
          <div class="columns medium-12" id="content-{uid}{iterator.cycle}-products">
            <f:for each="{products}" as="product" key="contentKey">
              <div class="row columns">
                <f:link.page pageUid="{pageID}" class="ib-link-more-after"
                  additionalParams="{tx_ibcontent:'{aid:product.id}'}">
                  {product.name}
                </f:link.page>
              </div>
            </f:for>
          </div>
        </div>
        <div class="row columns ib-collapsible-divider"></div>
      </div>
    </div>
  </div>
</f:if>

<f:comment>locations</f:comment>
<f:if condition="{locations}">
  <div class="row columns ib-content-module ib-collapsible ib-background-white ib-noTopBottomPadding">
    <div class="row" id="ib-collapsible-{uid}{iterator.cycle}-locations">
      <div class="columns small-1 large-1-2col ib-collapsible-icon ib-collapsible-trigger"
        data-ibcollapsibleid="{uid}{iterator.cycle}-locations">
        <span class="ib-iconwrapper">
          <i class="ib-icon-arrow-right"></i>
          <span>
      </div>
      <div class="columns small-10 large-6-2col end">
        <div class="ib-collapsible-header ib-collapsible-trigger rs_preserve"
          data-ibcollapsibleid="{uid}{iterator.cycle}-locations"
          id="{v:format.eliminate(content:collapsible.ItemWrap.title, whitespace:1)}">
          <f:if condition="{location.Location.related_locations_headline} != ''">
            <f:then>
              <h2 class="ib-headline">{location.Location.related_locations_headline}</h2>
            </f:then>
            <f:else>
              <h2 class="ib-headline">Weitere Standorte</h2>
            </f:else>
          </f:if>
        </div>
        <div class="row ib-collapsible-content" id="ib-collapsible-content-{uid}{iterator.cycle}-locations">

          <div class="columns medium-12" id="content-{uid}{iterator.cycle}-locations">
            <f:for each="{locations}" as="location" key="contentKey">
              <div class="row columns">
                <f:link.page pageUid="{locationtargetpage}" class="ib-link-more-after"
                  additionalParams="{tx_ibcontent:'{lid:location.id}'}">
                  {location.name}
                </f:link.page>
              </div>
            </f:for>
          </div>
        </div>
        <div class="row columns ib-collapsible-divider"></div>
      </div>
    </div>
  </div>
</f:if>